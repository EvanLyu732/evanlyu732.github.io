<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>


    
        <link rel="alternate" type="application/rss+xml" title="RSS" href="https://evanlyu732.github.io/atom.xml">
    
    
    
        
    
    
    
    
    
    
        
    
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <title>evan lyu</title>
    <meta charset="utf-8">
    <meta name="title" content="evan lyu">
    <meta name="description" content="">
    <meta property="og:image:width" content="200" />
    <meta property="og:image:height" content="200" />
    <link rel="stylesheet" href="https:&#x2F;&#x2F;evanlyu732.github.io/style.css">
    
    
    <style>
    @media screen and (min-width: 320px) {
        body {
            font-size: calc(16px + 2 * ((100vw - 320px) / 960));
        }
    }
    </style>
    
    <link rel="stylesheet" href="https://fonts.loli.net/css2?family=Source+Serif+Pro:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@400;700&display=swap">
    <style>body { font-family: 'Source Serif Pro', 'Source Han Serif SC', 'Noto Serif CJK SC', 'Noto Serif SC', serif }</style>
    
</head>
<body>
    
    <header class="header">
        <div class="blog-title"><a href="https:&#x2F;&#x2F;evanlyu732.github.io" class="logo">evan lyu</a></div>
        <nav class="navbar">
    <ul class="menu">
        
        
        <li class="menu-item">
            
            
            
            
            <a href="https:&#x2F;&#x2F;evanlyu732.github.io&#x2F;" class="current-menu-item-link">主页</a>
            
        </li>
        
        <li class="menu-item">
            
            
            
            
            <a href="https:&#x2F;&#x2F;evanlyu732.github.io&#x2F;archives" class="menu-item-link">归档</a>
            
        </li>
        
        <li class="menu-item">
            
            
            
            
            <a href="https:&#x2F;&#x2F;evanlyu732.github.io&#x2F;about" class="menu-item-link">关于</a>
            
        </li>
        
        <li class="menu-item">
            
            
            
            
            <a href="https:&#x2F;&#x2F;evanlyu732.github.io&#x2F;note" class="menu-item-link">书架</a>
            
        </li>
        
        <li class="menu-item">
            
            
            
            
            <a href="https:&#x2F;&#x2F;evanlyu732.github.io&#x2F;atom.xml" class="menu-item-link">订阅</a>
            
        </li>
        
    </ul>
</nav>

    </header>
    
    <main class="main">
        
<section class="posts">
    
    <article class="post">
        <div class="post-title"><a href="https:&#x2F;&#x2F;evanlyu732.github.io&#x2F;blog45&#x2F;" class="post-title-link">春节后开工LLM学习记录</a></div>
        <div class="post-content">
            
                <p>春节期间手机完全被DeepSeek-R1刷屏了, 无论是海内外媒体都疯狂讨论DeepSeek-R1. 趁着假期返工花了一整天大致了解了DeepSeek-R1的实现主体. 之后刚好同一天Andrej Karpathy发了<a href="https://www.youtube.com/watch?v=7xTGNNLPyMI">Deep Dive into LLMs like ChatGPT</a>. 查阅了一天资料, 有些心得. 写下此文, 也是记录自己如何了解新的技术.</p>
<h1 id="ji-lu">记录</h1>
<pre data-lang="txt" style="background-color:#eff1f5;color:#4f5b66;" class="language-txt "><code class="language-txt" data-lang="txt"><span>20250206:0910 早上到公司 
</span><span>目标: 了解DeepSeek-R1以及为什么R1会这么火 
</span><span>背景: 无任何关于DeepSeek-R1的资料阅读, 没读过论文
</span><span>
</span><span>20250206:0932 动作: 刷hacker news关于deepseek的post, 看各个thread的观点
</span><span>    * 动作: 跟着Simon Willison的blog(DeepSeek-R1 and exploring DeepSeek-R1-Distill-Llama-8B)实现本地ollama跑DeepSeek-R1-Distill-Llama-8B-GGUF
</span><span>    * 收获: 了解了DeepSeek-R1-Zero, DeepSeek-R1以及DeepSeek蒸馏模型的关系.
</span><span>
</span><span>20240206:1014 动作: 看yt视频# DeepSeek R1 Theory Overview | GRPO + RL + SFT
</span><span>    * 收获: 
</span><span>      * 整个DS-R1被训练出来的脉络, 博主画了个图, 表达很清楚, 见附录[1]
</span><span>      * 什么是GRPO以及GRPO公式大概的含义
</span><span>      * 相比于OpenAI闭源的COT推理能力[2], DS开源了如何实现推理模型
</span><span>      * 知道了GRPO是R1的重点
</span><span>
</span><span>20240206:1030 动作: 看yt视频: # Group Relative Policy Optimization (GRPO) - Formula and Code
</span><span>    * 衍生动作: 
</span><span>      * 看yt video视频 # Proximal Policy Optimization (PPO) - How to train Large Language Models
</span><span>      * 看了看知乎上关于GRPO的讨论和解析
</span><span>	* 收获: 
</span><span>        * 了解了PPO的大致流程
</span><span>        * 大致了解了GRPO, 但还是不懂, 需要找个场景实现一下. #TODO 
</span><span>        * 刷到了王兴兴关于GRPO的讨论和解析[3], 深入研究下GRPO在机器人控制的应用中 #TODO
</span><span>
</span><span>20240206:1414 动作: 看yt视频 # Building a fully local &quot;deep researcher&quot; with DeepSeek-R1
</span><span>	* 收获: 
</span><span>        * 了解了如何用langchain使用r1达到像openai deep research类似的效果, 以后可以考录用api部署一个试下 #TODO
</span><span>
</span><span>20240206:1442: 动作: 看yt视频 # Paper: DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning
</span><span>	* 收获: 
</span><span>        *  自回归模型的输出可以被看成是一个RL的过程
</span><span>        *  大致跟着视频过了一遍论文, 没仔细看
</span><span>        *  这个视频长度大概一个小时, 百分之80的时间都在讲GRPO, 所以GRPO一定是R1的重点.
</span><span>
</span><span>20240206:16:00 - 20240207:11:30:  动作: 看yt视频 # Deep Dive into LLMs like ChatGPT
</span><span>	* 收获(这个视频是我看到关于LLM最干的视频, 强烈推荐观看原版3个小时): 
</span><span>        *  LLM的训练流程为预训练(Pre-Training)产生基座模型(Base Model),
</span><span>           但是Base Model不具有对话的能力, 因此要通过后训练(Post Training),
</span><span>           通过SFT(Supervised Fine-Tuning)的方式, 输入多轮对话的数据, 来让
</span><span>           模型有对话的能力. 最后通过Post Training RL, 来让模型有推理能力.
</span><span>        * PreTraining阶段, 数据集和分词过程决定了Base Model的效果
</span><span>        * PreTraining阶段, 通过不断改变context size, 模型能够实现in context learning能力
</span><span>        * 由于Base Model本质上根据互联网数据的词语接龙, 因此幻觉一定会存在
</span><span>        * 幻觉可以通过改变post training SFT的数据集, 或者使用tool use能够减少
</span><span>        * 模型需要更多的token去做思考
</span><span>        * 模型不擅长做in memory computing
</span><span>        * 要让模型能在post training中实现tool use的能力,就是在SFT中加入pre training没见过的token
</span><span>        * knowledge in the parameters =&gt; vague recollection 
</span><span>        * knowledge in the token of context window =&gt; working memory 
</span><span>        * 以人阅读一本教材进行学习为例, 训练模型学习书中的背景知识就是pre training, 学会书中的例题称为post training. 而完成课后习题就是post training with RL 
</span><span>        * 在最后一个阶段post training with RL, 需要喂模型课后题(prompt), 并且人类给出打分. 由于这个过程需要进行很多次, RLHF通过拟合人类回答的偏好. 来实现自动训练.
</span><span>        * RLHF不算RL, 而是微调模型来达到人类偏好
</span><span>        * DeepSeek R1的aha moment和AlphaGo Zero的Aha moment很像, 训练效果都是非线性的, 一开始上升非常缓慢, 到了某一刻急速上升.
</span><span>        * 通过[4]可以了解AI的最新动态
</span><span>        * 通过[5]可以了解AI的排名
</span></code></pre>
<h1 id="zong-jie">总结</h1>
<p>之前我也在别的地方刷到R1实现了更低成本的训练, 例如使用PTX而不是raw cuda等, 这算infra层的创新. 但是我看的视频下来 <strong>开源的推理模型, 以及纯RL而不用SFT(DeepSeek-R1-Zero)</strong> 或许是R1更大的意义.</p>
<h1 id="sheng-xia-de-todo">剩下的TODO</h1>
<ul>
<li>找一个场景复现PPO以及GRPO</li>
<li>刚好在2月7号, o3-mini开源了思维链的过程, 对比一下</li>
<li>了解下RL-LLM的现状, 输出一篇文章</li>
<li>阅读R1原文, 自己总结一下, 并对比这篇<a href="https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&amp;mid=2247545512&amp;idx=1&amp;sn=3826ae3f788e8b90ffeb8fb3cc908c6e&amp;chksm=e8eafcecde166feebab4345c2d027cca4c9574c6058f90df5fe4513cefae17180f2344507e31&amp;mpshare=1&amp;srcid=0207SpaQkGmiF7zHxsYYVcxv&amp;sharer_shareinfo=72ac166e2fd073a2d05195fba0d13c61&amp;sharer_shareinfo_first=72ac166e2fd073a2d05195fba0d13c61&amp;from=singlemessage&amp;scene=1&amp;subscene=10000&amp;sessionid=1738908596&amp;clicktime=1738912215&amp;enterid=1738912215&amp;ascene=1&amp;fasttmpl_type=0&amp;fasttmpl_fullversion=7592104-zh_CN-zip&amp;fasttmpl_flag=0&amp;realreporttime=1738912215423&amp;devicetype=android-34&amp;version=28003855&amp;nettype=WIFI&amp;abtest_cookie=AAACAA%3D%3D&amp;lang=zh_CN&amp;countrycode=AD&amp;exportkey=n_ChQIAhIQysgSGGYJ6guKNuOW3xqwIBLnAQIE97dBBAEAAAAAAMNIGcR4l2MAAAAOpnltbLcz9gKNyK89dVj0BWdk0ar1sZ1xZJAIx0fAVnhfktWB%2Fz8itbQaTOFkU4h7gQp9odCzk1ocQAS2AUeWAu3HuMOHuo%2B%2FRg4fqobn1Sj%2FGrp4kC2%2FwnQlidKKe9rC6DG9QskGXu%2Bd98s3PWSu9KCdhFPBcrHoj4jUqJQ5Kz7qS%2BImYs1u3W1vlhbKXcsLlzKIyFwXeDEPA4g8M3ykfYORxphxXaIw3Pf%2Bk6zjwSjkWZGQXrWe8KOI6k6kgOm2EZ4zt7jgZZ1WwC3xAUzQXA%3D%3D&amp;pass_ticket=Qc%2FprbYOLQVh%2BBnvnYJVgLdkqVNLBJx%2BkqpS%2FYUP3njk1%2BHNc0IUwJ%2BW1jQKEFwe&amp;wx_header=3">文章</a>, 了解更多的技术细节.</li>
<li>pi0开源了, 研究下pi0</li>
<li>借助xxx平台提供的api, 实现一个属于自己的deep research. 也算是往agentic ai迈了一步.</li>
<li>总结下DS的发展路线, 输出一篇文章</li>
</ul>
<h1 id="fu-lu">附录</h1>
<p>[1] <a href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fdf800d6c-7a41-49b0-b5d8-5e13620cb6f1_1043x1200.png">(yt video # DeepSeek R1 Theory Overview | GRPO + RL + SFT)各个模型关系图</a></p>
<p>[2] <a href="https://openai.com/index/learning-to-reason-with-llms/">Hiding the Chains of Thought - OpenAI</a></p>
<p>[3] <a href="https://zhuanlan.zhihu.com/p/21131372654">DeepSeek GRPO在简单控制系统上和PPO的对比</a></p>
<p>[4] <a href="https://buttondown.com/ainews">AI News</a></p>
<p>[5] <a href="https://lmarena.ai/">LM Arena for model rankings</a></p>
<hr />
<h1 id="20240208geng-xin">20240208更新</h1>
<p>接着上片文章, 在2月7日的时候, 我一直在找如何请求deepseek-r1 api的方式. 因此现在ds大火, 服务器一直繁忙. 想找个渠道试一下r1都难. 也尝试了<a href="https://www.silicon-flow.com/">硅基流动</a>以及一些其他的api提供商. 因为是尝试, 不太想直接往api服务商充钱. 于是, 截至到今日(20250208), 我试下来有两种免费方式可以请求deepseek-r1.</p>
<ol>
<li><a href="https://console.bce.baidu.com/qianfan/ais/console/onlineTest/LLM/DeepSeek-V3">百度千帆</a></li>
<li><a href="https://cloud.infini-ai.com/genstudio/experience">无问苍穹</a></li>
</ol>
<p>目前这两个平台的api请求是免费的, 无问苍穹会快很多, 并且api的速度远比不上playground. 并且两个平台的api稳定性都不太好, 会有请求失败的问题. 之后, 我用cursor写了一个适配于百度千帆的命令行工具. 效果如下.</p>
<p><img src="https://raw.githubusercontent.com/EvanLyu732/evanlyu732.github.io/refs/heads/main/static/images/tui.gif" alt="bd_llm_tui demo" /></p>
<p>顺便试了下百度的其他免费的模型, 响应速度还行.
仓库链接点击<a href="https://github.com/EvanLyu732/bd_llm_tui">这里</a></p>

            
        </div>
        <div class="post-meta">
            
                


二〇二五年二月七日

            
        </div>
    </article>
    
    <article class="post">
        <div class="post-title"><a href="https:&#x2F;&#x2F;evanlyu732.github.io&#x2F;blog44&#x2F;" class="post-title-link">2024年难忘的书</a></div>
        <div class="post-content">
            
                <h1 id="2025nian-xin-nian-kuai-le">2025年新年快乐!!!</h1>
<p>2025年新年快乐!!! 祝2025年蛇年活力四射. 祝新的一年是节节升高, 万事如意. 这一篇文章分享我在2024年读过几本难忘的书(排除上一篇文章提到的&quot;控制论与科学方法论&quot;). 以下顺序按照安利程度排名.</p>
<h1 id="shu-dan">书单</h1>
<ol>
<li><a href="https://www.amazon.com/Tao-Physics-Exploration-Parallels-Mysticism/dp/1590308352">The Tao of Physics: An Exploration of the Parallels between Modern Physics and Eastern Mysticism</a>: 这是我在2024年读过最特别的一本书没有之一, 因此我想在这里推荐给你, 如果只让我推荐一本书, 我会选这本. 因为这本书用最清晰的语言回答了科学(物理学)和玄学(宗教,东方哲学)的起源以及它们之间的联系. 看完这本书你能够理解为什么最开始的人们会选择相信宗教, 为什么宗教不是迷信. 会对玄学产生更多的敬畏以及探索. 以及玄学和科学最开始会分源而不是一起发展. 分享几句书中的摘要:</li>
</ol>
<blockquote>
<p>Fishing baskets are employed to catch fish; but when the fish are got, the men forget the baskets; snares are employed to catch hares; but when the hares are got, men forget the snares. <strong>Words are employed to convey ideas; but when the ideas are grasped, men forget the words.</strong></p>
</blockquote>
<p>语言是指表达想法的&quot;工具&quot;. 当语言背后的点子传递到了, 语言也不重要了.</p>
<blockquote>
<p><strong>The basis of Krishna's spiritual instruction, as of all Hinduism, is the idea that the multitude of things and events around us are but different manifestations of the same ultimate reality. This reality, called Brahman, is the unifying concept which gives Hinduism its essentially monistic character in spite of the worship of numerous gods and goddesses.</strong></p>
</blockquote>
<p>印度教里面的&quot;神&quot;指的不是一个具有超能力的&quot;神&quot;. 而是能够让世界按照不同稳态的状态运行的&quot;规律&quot;. 而印度教里面认为这些&quot;规律&quot;实际是同一个&quot;东西&quot;, 只是在各个状态下, 它们有着不同的表现. </p>
<blockquote>
<p>Nagarjuna's statement that the essential nature of reality is emptiness is thus far from being the nihilist statement for which it is often taken. It merely means that all concepts about reality formed by the human mind are ultimately void. <strong>Reality, or Emptiness, itself is not a state of mere nothingness, but is the very source of all life and the essence of all forms.</strong></p>
</blockquote>
<p>佛教里面的&quot;空&quot;或者&quot;无&quot;. 并不是&quot;没有&quot;, 或者&quot;消失&quot;了. 而是一种没有具体的形(formless), 缺又是一切有形状事物的源头. 意味着&quot;无&quot;是无处不在.</p>
<blockquote>
<p>The repeatability of the experience is, in fact, essential to every mystical training and is the very aim of the mystics' spiritual instruction.</p>
</blockquote>
<p>东方神秘主义的核心是直接体验, 科学会说东方神秘主义不具有可证伪性(falsifiability). 但是如果能够以第一人称视角体验到了. 它就不是迷信.</p>
<ol start="2">
<li>
<p><a href="https://www.amazon.com/How-Think-Like-Leonardo-Vinci/dp/0440508274">How to think like Leonardo Da Vinci seven steps to genius every day</a>: 这本书是取了看似没什么营养的名字, 但是讲了非常多能够帮助你解决问题并且可以实际操作的事项. 举个例子, 书中的第一章是关于达芬奇是如何好奇身边的事物的. 那如何变的好奇呢? 书中有提到<strong>写100个能够帮助你的问题</strong>. 我尝试了一下写20个问题就写不出来了. 提出的问题越多说明发现了不同的细节. 书中拆解了达芬奇七种不同的品质, 并且安排了合理可操作的练习来培养这些品质. 强烈推荐.</p>
</li>
<li>
<p><a href="https://www.amazon.com/Second-Law-Resolving-Mystery-Thermodynamics/dp/1579550835">The Second Law: Resolving the Mystery of the Second Law of Thermodynamics</a>: 这本书是关于热力学第二定律的起源以及从计算复杂性的视角去解读. 我在24年的读完这本书时候写过一篇<a href="https://evanlyu732.github.io/blog19/">文章</a>. 作者Stephen Wolfram非常博学, 看完本书能够让你从不一样的视角了解热力学第二定律. </p>
</li>
<li>
<p><a href="https://www.amazon.com/Language-Thought-Action-S-I-Hayakawa/dp/0156482401">Language in Thought and Action</a>: 这本书是关于语言是如何形成和如何影响我们的想法的. 更重要的这是一本关于&quot;抽象&quot;的书籍. &quot;抽象&quot;是如何形成的? 语言和抽象之间有什么关系? 为什么有些事情无法达成共识? 这本书很好的回答了这些问题. 非常值得推荐.</p>
</li>
<li>
<p><a href="https://www.amazon.com/Psycho-Cybernetics-Updated-Expanded-Maxwell-Maltz/dp/0399176136/ref=sr_1_1?adgrpid=128521906692&amp;dib=eyJ2IjoiMSJ9.O5H-kouhIgmvh6dPMHHhHY1RoTPE1ciVatfm5MziTLSVSYSUPHCFLYxNTKgMMBILcgciMrovgyM9XdEHzofm3C4fu6V4x3GQZvdqD9NV6POWrMxkFzr_xDCa7wNqr-CB1tyxyGb9aXxr5Pg4wflBj0Ar63bRy-iPijsjxNRiHWwPx8eyX3UlCLJmvYZMFWFTsZQcaw8mTPti0FkdLj6BEl08mwtY239n5-mXqGyqumU.66IBImfGIYWzDaXW_9rZ2OTD_jRd86GkCXF-sXv8Cy8&amp;dib_tag=se&amp;hvadid=673526597249&amp;hvdev=c&amp;hvlocphy=2344&amp;hvnetw=g&amp;hvqmt=e&amp;hvrand=13065075103364209520&amp;hvtargid=kwd-297246306449&amp;hydadcr=22016_13508085&amp;keywords=psycho+cybernetics&amp;qid=1735626505&amp;sr=8-1">Psycho-Cybernetics</a>: 这本书是关于如何使用控制论的方法去改变自己心理的自我描述. 比如如何练习放松, 如何利用想象状态来改变自己的行为等. 和第二本书一样, 需要实际完成对应的练习才能体验到作者想表达的精髓. </p>
</li>
</ol>

            
        </div>
        <div class="post-meta">
            
                


二〇二五年一月一日

            
        </div>
    </article>
    
    <article class="post">
        <div class="post-title"><a href="https:&#x2F;&#x2F;evanlyu732.github.io&#x2F;blog43&#x2F;" class="post-title-link">控制论与科学方法论读后感</a></div>
        <div class="post-content">
            
                <p>大概在上周的时候, 我看完了<a href="https://www.goodreads.com/zh/book/show/37419698">控制论与科学方法论</a>. 很少有书籍在看完之后能让人有方法论提升的感觉. 如果你还没看过这本书, 这本书值得放到你的书单里面. 里面有非常多精彩的观点和例子. 这本书值得被翻译成英文版. 其中关于&quot;曹冲称象&quot;的例子令人印象深刻. 先让我们来快速回顾一下: </p>
<blockquote>
<p>孙权给曹操送了一头大象，曹操想知道大象有多重. 但是没有这么大的秤, 大臣们都没办法, 这时候曹冲想出来了一个办法. 先将大象牵到岸边的一艘船上. 记录下这时候的水位线. 再把大象替换成石头块，使得两次水位线高度一样. 最后记录石头块的总重量就是大象的重量.</p>
</blockquote>
<p>曹冲的这种思想方法在控制论叫做<strong>共轭控制(Inferential Control)</strong>:</p>
<ol>
<li>大象的重量等于等价石头的重量, 把这一步变换过程用L表示</li>
<li>称出石头的重量,这一步用A表示</li>
<li>等价石头的重量等于大象的重量. 把这一步变换过程用L-1(L的逆)表示</li>
</ol>
<img src="https://raw.githubusercontent.com/EvanLyu732/evanlyu732.github.io/main/static/images/lal.png" height="100" width="100"/>
<p>共轭变换的思想可以说是解决问题的一种经典范式(scheme). 举个例子, 在自动驾驶问题当中, 有一种解决思路就是将感知域的信息映射到文本域, 在文本域处理完结果, 再映射到车辆的执行状态. 比如<a href="https://leimao.github.io/blog/DriveGPT/">DriveGPT</a>系列. 再比如最近的科研界Meta今年年初发的<a href="https://arxiv.org/abs/2402.14083">Beyond A*: Better Planning with Transformers via Search Dynamics Bootstrapping</a>也是一样的思路, 将基于离散图的规划问题映射到文本域从而变成symbolic planning. <a href="https://evanlyu732.github.io/blog12/#:~:text=%E5%9C%A8%22The%20Dawning,llms%20take%20all.">在现有的牛顿范式的方法中进行采样变成开普勒范式方法的输入, 从而使得开普勒范式方法能够与牛顿范式的方法达到一样甚至超越的效果.</a></p>
<p>此外这本书关于系统的类型以及演化，黑盒认识论, 量变与质变的论述都非常精彩. 将书中的方法论套用到自己生活所面临的场景中有不一样的思路. 另外有一本非常值得推荐的书是<a href="https://www.amazon.com/Psycho-Cybernetics-Updated-Expanded-Maxwell-Maltz/dp/0399176136">Psycho-Cybernetics</a>里面讲如何运用控制论的方法改变自己的self-image. 不同于传统的鸡汤文学. 我个人在尝试了书中的练习后觉得效果很好. </p>

            
        </div>
        <div class="post-meta">
            
                


二〇二四年十二月廿一日

            
        </div>
    </article>
    

</section>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        var Home = location.href,
        xhr,
        xhrUrl = '';
    
        var Diaspora = {
            L: function(url, f, err) {
                if (url == xhrUrl) {
                    return false;
                }
                xhrUrl = url;
                if (xhr) {
                    xhr.abort();
                }
                xhr = $.ajax({
                    type: 'GET',
                    url: url,
                    timeout: 10000,
                    success: function(data) {
                        f(data);
                        xhrUrl = '';
                    },
                    error: function(a, b, c) {
                        if (b == 'abort') {
                            err && err()
                        } else {
                            window.location.href = url;
                        }
                        xhrUrl = '';
                    }
                });
            },
            loading: function() {
                var w = window.innerWidth;
                var css = '<style class="loaderstyle" id="loaderstyle'+ w +'">'+
                    '@-moz-keyframes loader'+ w +'{100%{background-position:'+ w +'px 0}}'+
                    '@-webkit-keyframes loader'+ w +'{100%{background-position:'+ w +'px 0}}'+
                    '.loader'+ w +'{-webkit-animation:loader'+ w +' 3s linear infinite;-moz-animation:loader'+ w +' 3s linear infinite;}'+
                    '</style>';
                $('.loaderstyle').remove()
                $('head').append(css)
                $('#loader').removeClass().addClass('loader'+ w).show()
            },
            loaded: function() {
                $('#loader').removeClass().hide()
            }
        };
    
        $(function() {
            $('body').on('click', function(e) {
                var tag = $(e.target).attr('class') || '',
                    rel = $(e.target).attr('rel') || '';
                if (!tag && !rel) return;
                switch (true) {
                    // next page
                    case (tag.indexOf('more') != -1):
                        tag = $('.more');
                        if (tag.data('status') == 'loading') {
                            return false
                        }
                        var num = parseInt(tag.data('page')) || 1;
                        if (num == 1) {
                            tag.data('page', 1)
                        }
                        tag.html("旧文").data('status', 'loading')
                        Diaspora.loading()
                        Diaspora.L(tag.attr('href'), function(data) {
                            tag.hide();
                            $('.license').hide();
                            var link = $(data).find('.more').attr('href');
                            if (link) {
                                tag.attr('href', link).html("旧文").data('status', 'loaded')
                                tag.data('page', parseInt(tag.data('page')) + 1)
                            }

                            var tempScrollTop = $(window).scrollTop();
                            $('body').append($(data).find('.posts'))
                            $(window).scrollTop(tempScrollTop + 100);
                            Diaspora.loaded()
                            //$('html,body').animate({ scrollTop: tempScrollTop + 400 }, 500);
                            if (link !== '/' && link != '') {
                                $('body').append($(data).find('.page-nav'))
                            }
                        }, function() {
                            tag.html("旧文").data('status', 'loaded')
                        })
                        return false;
                        break;
                    default:
                        return true;
                        break;
                }
            });
        })
    </script>
    
    <nav class="page-nav">
      <a href="https:&#x2F;&#x2F;evanlyu732.github.io&#x2F;page&#x2F;2&#x2F;" class="more">旧文</a>
    </nav>


    </main>
    
    <p class="license"></p>
    
</body>
</html>
